<!DOCTYPE html>
<html lang="en">

<!--   Tue, 07 Jan 2020 03:33:27 GMT -->

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport">
    <title>Dashboard &mdash; ICUBATOR</title>
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">

    <!-- General CSS Files -->
    <link rel="stylesheet" href="assets/modules/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/modules/fontawesome/css/all.min.css">

    <!-- CSS Libraries -->
    <link rel="stylesheet" href="assets/modules/jqvmap/dist/jqvmap.min.css">
    <link rel="stylesheet" href="assets/modules/summernote/summernote-bs4.css">
    <link rel="stylesheet" href="assets/modules/owlcarousel2/dist/assets/owl.carousel.min.css">
    <link rel="stylesheet" href="assets/modules/owlcarousel2/dist/assets/owl.theme.default.min.css">

    <!-- Template CSS -->
    <link rel="stylesheet" href="assets/css/style.min.css">
    <link rel="stylesheet" href="assets/css/components.min.css">

</head>

<body class="layout-4">
    <!-- Page Loader -->
    <div class="page-loader-wrapper">
        <span class="loader"><span class="loader-inner"></span></span>
    </div>

    <div id="app">
        <div class="main-wrapper main-wrapper-1">
            <div class="navbar-bg"></div>

            <!-- Start app top navbar -->
            <nav class="navbar navbar-expand-lg main-navbar">
                <form class="form-inline mr-auto">
                    <ul class="navbar-nav mr-3">
                        <li><a href="#" data-toggle="sidebar" class="nav-link nav-link-lg"><i
                                    class="fas fa-bars"></i></a></li>
                        <li><a href="#" data-toggle="search" class="nav-link nav-link-lg d-sm-none"><i
                                    class="fas fa-search"></i></a></li>
                    </ul>
                    <div class="search-element">
                        <input class="form-control" type="search" placeholder="Search" aria-label="Search" data-width="250">
                        <button class="btn" type="submit"><i class="fas fa-search"></i></button>
                        <div class="search-backdrop"></div>
                        <div class="search-result">
                            <div class="search-header">Histories</div>
                            <div class="search-item">
                                <a href="#">How to Used HTML in Laravel</a>
                                <a href="#" class="search-close"><i class="fas fa-times"></i></a>
                            </div>
                            <div class="search-item">
                                <a href="https://themeforest.net/user/admincraft/portfolio" target="_black">Admincraft
                                    Portfolio</a>
                                <a href="#" class="search-close"><i class="fas fa-times"></i></a>
                            </div>
                            <div class="search-item">
                                <a href="#">#CodiePie</a>
                                <a href="#" class="search-close"><i class="fas fa-times"></i></a>
                            </div>
                            <div class="search-header">Result</div>
                            <div class="search-item">
                                <a href="#">
                                    <img class="mr-3 rounded" width="30" src="assets/img/products/product-3-50.png" alt="product"> oPhone 11 Pro
                                </a>
                            </div>
                            <div class="search-item">
                                <a href="#">
                                    <img class="mr-3 rounded" width="30" src="assets/img/products/product-2-50.png" alt="product"> Drone Zx New Gen-3
                                </a>
                            </div>
                            <div class="search-item">
                                <a href="#">
                                    <img class="mr-3 rounded" width="30" src="assets/img/products/product-1-50.png" alt="product"> Headphone JBL
                                </a>
                            </div>
                            <div class="search-header">Projects</div>
                            <div class="search-item">
                                <a href="https://themeforest.net/item/epice-laravel-admin-template-for-hr-project-management/24466729" target="_black">
                                    <div class="search-icon bg-danger text-white mr-3"><i class="fas fa-code"></i></div>
                                    Epice Laravel - Admin Template
                                </a>
                            </div>
                            <div class="search-item">
                                <a href="https://themeforest.net/item/soccer-project-management-admin-template-ui-kit/24646866" target="_black">
                                    <div class="search-icon bg-primary text-white mr-3"><i class="fas fa-laptop"></i>
                                    </div>
                                    Soccer - Admin Template
                                </a>
                            </div>
                        </div>
                    </div>
                </form>
                <ul class="navbar-nav navbar-right">
                    <li class="dropdown dropdown-list-toggle"><a href="#" data-toggle="dropdown" class="nav-link nav-link-lg message-toggle beep"><i class="far fa-envelope"></i></a>
                        <div class="dropdown-menu dropdown-list dropdown-menu-right">
                            <div class="dropdown-header">Messages
                                <div class="float-right">
                                    <a href="#">Mark All As Read</a>
                                </div>
                            </div>
                            <div class="dropdown-list-content dropdown-list-message">
                                <a href="#" class="dropdown-item dropdown-item-unread">
                                    <div class="dropdown-item-avatar">
                                        <img alt="image" src="assets/img/avatar/avatar-1.png" class="rounded-circle">
                                        <div class="is-online"></div>
                                    </div>
                                    <div class="dropdown-item-desc">
                                        <b>Kusnaedi</b>
                                        <p>Hello, Bro!</p>
                                        <div class="time">10 Hours Ago</div>
                                    </div>
                                </a>
                                <a href="#" class="dropdown-item dropdown-item-unread">
                                    <div class="dropdown-item-avatar">
                                        <img alt="image" src="assets/img/avatar/avatar-2.png" class="rounded-circle">
                                    </div>
                                    <div class="dropdown-item-desc">
                                        <b>Dedik Sugiharto</b>
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit</p>
                                        <div class="time">12 Hours Ago</div>
                                    </div>
                                </a>
                                <a href="#" class="dropdown-item dropdown-item-unread">
                                    <div class="dropdown-item-avatar">
                                        <img alt="image" src="assets/img/avatar/avatar-3.png" class="rounded-circle">
                                        <div class="is-online"></div>
                                    </div>
                                    <div class="dropdown-item-desc">
                                        <b>Agung Ardiansyah</b>
                                        <p>Sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                                        <div class="time">12 Hours Ago</div>
                                    </div>
                                </a>
                                <a href="#" class="dropdown-item">
                                    <div class="dropdown-item-avatar">
                                        <img alt="image" src="assets/img/avatar/avatar-4.png" class="rounded-circle">
                                    </div>
                                    <div class="dropdown-item-desc">
                                        <b>Ardian Rahardiansyah</b>
                                        <p>Duis aute irure dolor in reprehenderit in voluptate velit ess</p>
                                        <div class="time">16 Hours Ago</div>
                                    </div>
                                </a>
                                <a href="#" class="dropdown-item">
                                    <div class="dropdown-item-avatar">
                                        <img alt="image" src="assets/img/avatar/avatar-5.png" class="rounded-circle">
                                    </div>
                                    <div class="dropdown-item-desc">
                                        <b>Alfa Zulkarnain</b>
                                        <p>Exercitation ullamco laboris nisi ut aliquip ex ea commodo</p>
                                        <div class="time">Yesterday</div>
                                    </div>
                                </a>
                            </div>
                            <div class="dropdown-footer text-center">
                                <a href="#">View All <i class="fas fa-chevron-right"></i></a>
                            </div>
                        </div>
                    </li>
                    <li class="dropdown dropdown-list-toggle"><a href="#" data-toggle="dropdown" class="nav-link notification-toggle nav-link-lg beep"><i class="far fa-bell"></i></a>
                        <div class="dropdown-menu dropdown-list dropdown-menu-right">
                            <div class="dropdown-header">Notifications
                                <div class="float-right">
                                    <a href="#">Mark All As Read</a>
                                </div>
                            </div>
                            <div class="dropdown-list-content dropdown-list-icons">
                                <a href="#" class="dropdown-item dropdown-item-unread">
                                    <div class="dropdown-item-icon bg-primary text-white">
                                        <i class="fas fa-code"></i>
                                    </div>
                                    <div class="dropdown-item-desc"> Template update is available now!
                                        <div class="time text-primary">2 Min Ago</div>
                                    </div>
                                </a>
                                <a href="#" class="dropdown-item">
                                    <div class="dropdown-item-icon bg-info text-white">
                                        <i class="far fa-user"></i>
                                    </div>
                                    <div class="dropdown-item-desc">
                                        <b>You</b> and <b>Dedik Sugiharto</b> are now friends
                                        <div class="time">10 Hours Ago</div>
                                    </div>
                                </a>
                                <a href="#" class="dropdown-item">
                                    <div class="dropdown-item-icon bg-success text-white">
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <div class="dropdown-item-desc">
                                        <b>Kusnaedi</b> has moved task <b>Fix bug header</b> to <b>Done</b>
                                        <div class="time">12 Hours Ago</div>
                                    </div>
                                </a>
                                <a href="#" class="dropdown-item">
                                    <div class="dropdown-item-icon bg-danger text-white">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <div class="dropdown-item-desc">
                                        Low disk space. Let's clean it!
                                        <div class="time">17 Hours Ago</div>
                                    </div>
                                </a>
                                <a href="#" class="dropdown-item">
                                    <div class="dropdown-item-icon bg-info text-white">
                                        <i class="fas fa-bell"></i>
                                    </div>
                                    <div class="dropdown-item-desc">
                                        Welcome to CodiePie template!
                                        <div class="time">Yesterday</div>
                                    </div>
                                </a>
                            </div>
                            <div class="dropdown-footer text-center">
                                <a href="#">View All </a>
                            </div>
                        </div>
                    </li>
                    <li class="dropdown">
                        <a href="#" data-toggle="dropdown" class="nav-link dropdown-toggle nav-link-lg nav-link-user">
                            <img alt="image" src="assets/img/avatar/avatar-1.png" class="rounded-circle mr-1">
                            <div class="d-sm-none d-lg-inline-block">Hi, Michelle Green</div>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right">
                            <div class="dropdown-title">Logged in 5 min ago</div>
                            <a href="features-profile.html" class="dropdown-item has-icon">
                                Profile</a>
                            <a href="features-activities.html" class="dropdown-item has-icon"> Activities</a>
                            <a href="features-settings.html" class="dropdown-item has-icon">
                                Settings</a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item has-icon text-danger">
                                Logout</a>
                        </div>
                    </li>
                </ul>
            </nav>

            <!-- Start main left sidebar menu -->
            <div class="main-sidebar sidebar-style-3">
                <aside id="sidebar-wrapper">
                    <div class="sidebar-brand">
                        <a href="index.html">HOME</a>
                    </div>

                    <ul class="sidebar-menu">
                        <li class="menu-header">Dashboard</li>
                        <li class="dropdown active">
                            <a href="indexdash.html" class="nav-link has-dropdown"><span>Incubator Dashboard</span></a>

                        </li>
                        <li class="menu-header">Starter</li>

                        <li>
                            <a class="nav-link" href="indexdash.html"> <span>Brooding room Dashboard</span></a>
                        </li>
                        <li class="menu-header">CodiePie</li>
                        <li class="dropdown">
                            <a href="contact.html" class="nav-link has-dropdown">
                                <span>Contact</span></a>

                        </li>

                        <li class="dropdown">
                            <a href="team.html" class="nav-link has-dropdown"> <span>Team</span></a>

                        </li>
                        <li class="dropdown">
                            <a href="#" class="nav-link has-dropdown">
                                <span>Modules</span></a>

                        </li>

                        <li class="dropdown">
                            <a href="about.html" class="nav-link has-dropdown">
                                <span>About us</span></a>
                            <ul class="dropdown-menu">

                            </ul>
                        </li>
                    </ul>
                    <div class="mt-4 mb-4 p-3 hide-sidebar-mini">
                        <a href="https://getcodiepie.com/docs" class="btn btn-primary btn-lg btn-block btn-icon-split"><i class="fas fa-rocket"></i>
                            Documentation</a>
                    </div>
                </aside>
            </div>

            <!-- Start app main Content -->
            <div class="main-content">
                <section class="section">
                    <div class="row row-deck">
                        <div class="col-lg-12"></div>
                        <div class="card">
                            <div class="card-header">select</div>
                            <div class="card-body">
                                <div class="form-group row">
                                    <div class="col-sm">
                                        <label for="select">Devices</label>
                                        <select class="form-control" id="selectDevice" onchange="onDeviceSelect()">
                                        </select>
                                    </div>
                                    <div class="col-sm">
                                        <label for="select">Sensors</label>
                                        <select class="form-control" id="selectSensor" onchange="onSensorSelect()">
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>



                    <div class="row row-deck">
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-header">
                                    <h4>Graph showing Humidity and Tempreator for Incubator </h4>
                                </div>
                                <div class="card-body">
                                    <canvas id="pk" height="400" width="900px">Loading...</canvas>
                                </div>
                            </div>
                        </div>

                    </div>

                </section>
            </div>

            <!-- Start app Footer part -->
            <footer class="main-footer">
                <div class="footer-left">
                    <div class="bullet"></div> <a href="templateshub.net">Go Smart, Go Incotech Smart Incubator the one you can trust.</a>
                </div>
                <div class="footer-right">

                </div>
            </footer>
        </div>
    </div>

    <!-- General JS Scripts -->
    <script src="assets/bundles/lib.vendor.bundle.js"></script>
    <script src="js/CodiePie.js"></script>

    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/waziup-js@2.0.0-alpha.10/lib/Waziup.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>

    <script>
        Waziup.ApiClient.instance.basePath = "https://api.waziup.io/api/v2";
        var devicesApi = new Waziup.DevicesApi();
        var sensorsApi = new Waziup.SensorsApi();
        // default device values
        var device_id = "UGB-PILOTS_Sensor200";
        var sensor_id = "TP";
        var sensorValues = [];
        var graphLabel = [];
        var myChart;

        // initializing
        loadDevices();
        loadSensors();

        function loadDevices() {
            // list of devices
            var selectDevice = document.getElementById("selectDevice");
            devicesApi.getDevices("waziup").then(devices => {
                for (device of devices) {
                    // create and populate an option for the select
                    var opt = document.createElement("option");
                    opt.value = device.id;
                    opt.innerHTML = device.id;

                    // then append it to the select element
                    selectDevice.appendChild(opt);
                }
            });
        }

        function loadSensors() {
            // list of sensors
            var selectSensor = document.getElementById("selectSensor");
            // reset sensor values
            sensorValues = [];
            devicesApi.getDeviceSensors(device_id).then(sensors => {
                sensors.forEach((sensor, index) => {
                    // set sensor_id to the first sensor
                    if (index == 0) {
                        sensor_id = sensor.id;
                    }
                    // create and populate an option for the select
                    var opt = document.createElement("option");
                    opt.value = sensor.id;
                    opt.innerHTML = sensor.id;

                    // then append it to the select element
                    selectSensor.appendChild(opt);

                    // get sensor values for each sensor
                    sensorsApi
                        .getSensorsData({
                            device_id,
                            sensor_id: sensor.id
                        })
                        .then(values => {
                            var data = [];

                            // reset graph label
                            if (values.length > 0) graphLabel = [];

                            // add each sensor values in an array
                            for (value of values) {
                                data.push(value.value);
                                if (value.timestamp) graphLabel.push(value.timestamp);
                            }

                            //
                            if (data.length > 0)
                                sensorValues.push({
                                    label: sensor.id + (sensor.unit ? "(" + sensor.unit + ")" : ""),
                                    data: data,

                                    backgroundColor: [
                                        'black',
                                        'yellow',
                                        'Red',
                                        'green',
                                        'blue',
                                        'white',
                                        'Red',
                                        'Blue',
                                        'Yellow',
                                        'Green',
                                        'Purple',
                                        'Orange',
                                        'green',
                                        'blue',
                                        'white',
                                        'Red',
                                        'Blue',
                                        'Yellow',
                                        'Green',
                                        'Red',
                                        'Yellow'
                                    ],
                                    borderColor: dynamicColors()
                                });
                        })
                        .finally(values => {
                            loadGraph();
                        });
                });
                loadValues();
            });
        }

        // select device

        var selectedDevice = 'IncubatorINCOTECH'
        device_id = selectedDevice;
        // reset sensors list
        loadSensors();


        // select sensor
        var selectedSensor = 'huminco'
        sensor_id = selectedSensor;
        loadValues();


        // random color generator
        var dynamicColors = function() {
            var r = Math.floor(Math.random() * 255);
            var g = Math.floor(Math.random() * 255);
            var b = Math.floor(Math.random() * 255);
            return "rgb(" + r + "," + g + "," + b + ")";
        };

        // load device and sensor values
        function loadValues() {
            // device context
            devicesApi.getDevice(device_id).then(device => {
                document.getElementById("device_name_context").innerHTML =
                    "Name : " + device.name;
                document.getElementById("device_owner").innerHTML =
                    "Owner : " + device.owner;
                document.getElementById("device_domain").innerHTML =
                    "Domain : " + device.domain;
                document.getElementById("device_gateway").innerHTML =
                    "Gateway : " + device.gateway_id;
            });

            // device value
            sensorsApi.getSensor(device_id, sensor_id).then(device => {
                document.getElementById("device_value_id").innerHTML = device.id;
                document.getElementById("device_name_value").innerHTML =
                    "Name : " + device.name;
                document.getElementById("device_last_value").innerHTML =
                    "Last Value : " + device.value.value;
                document.getElementById("device_quantity_kind").innerHTML =
                    "Quantity Kind : " + device.quantity_kind;
                document.getElementById("device_sensing_device").innerHTML =
                    "Sensing Device : " + device.sensing_device;
                document.getElementById("device_unit").innerHTML =
                    "Unit : " + device.unit;
            });
        }

        // load graph with device values
        function loadGraph() {
            // if chart already exists update dataset
            if (myChart) {
                myChart.data.labels = graphLabel;
                myChart.data.datasets = sensorValues;
                myChart.update();
            } else {
                var ctx = document.getElementById("pk").getContext("2d");
                myChart = new Chart(ctx, {
                    type: "pie",
                    data: {
                        labels: graphLabel,
                        datasets: sensorValues
                    },
                    options: {
                        responsive: false
                    }
                });
            }
        }

        // map
        var mymap = L.map("mapid").setView([-1.97, 30.1], 8);
        L.tileLayer(
            "https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}", {
                attribution: 'Map data © <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
                maxZoom: 8,
                id: "mapbox.streets",
                accessToken: "pk.eyJ1IjoiY2R1cG9udDIiLCJhIjoiY2pnZTVkZ2xsMGxyZTJ4cjA5dDZ4cjNneSJ9.NJT7CULfcY0mjeavffR_vg"
            }
        ).addTo(mymap);

        var markers = [];
        devicesApi
            .getDevices({
                limit: 1000
            })
            .then(devices => {
                for (device of devices) {
                    if (device.location) {
                        L.marker([
                            device.location.latitude,
                            device.location.longitude
                        ]).addTo(mymap);
                    }
                }
            });
    </script>

    <!-- JS Libraies -->
    <script src="assets/modules/jquery.sparkline.min.js"></script>
    <script src="assets/modules/owlcarousel2/dist/owl.carousel.min.js"></script>
    <script src="assets/modules/summernote/summernote-bs4.js"></script>
    <script src="assets/modules/chocolat/dist/js/jquery.chocolat.min.js"></script>

    <!-- Page Specific JS File -->
    <script src="js/page/index.js"></script>

    <!-- Template JS File -->
    <script src="js/scripts.js"></script>
    <script src="js/custom.js"></script>
</body>

<!--   Tue, 07 Jan 2020 03:35:12 GMT -->

</html>